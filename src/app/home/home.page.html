<ion-content>
    <ion-grid *ngIf="!isLoading && !!backgroundImage">
        <ion-row>
            <ion-col size-md="12" size-lg="8" offset-lg="2">
                <div class="header-container">
                    <img id="bgImage" class="bg-img" [src]="backgroundImage" />

                    <div id="open-logout-modal" class="top-right">
                        <span class="material-icons-outlined"> logout </span>
                    </div>
                    <ion-modal trigger="open-logout-modal" id="logout-modal">
                        <ng-template>
                            <div class="container">
                                <ion-row>
                                    <ion-col>
                                        <h3>Abmelden</h3>
                                        <p>Sind Sie sicher, dass Sie sich abmelden möchten?</p>
                                        <ion-button (click)="onLogout()"> Abmelden </ion-button>
                                        <ion-button class="outlined" (click)="onDismissLogoutModal()">
                                            Zurück
                                        </ion-button>
                                    </ion-col>
                                </ion-row>
                            </div>
                        </ng-template>
                    </ion-modal>

                    <div class="centered-vertical">
                        <ion-row class="centered-horizontal">
                            <ion-col>
                                <h1 (click)="onOpenMaster()">{{house.pageTitle}}</h1>

                                <hr />

                                <h5>{{house.pageSubtitle}}</h5>
                            </ion-col>
                        </ion-row>
                    </div>
                </div>
            </ion-col>
        </ion-row>

        <ion-row *ngIf="user.role !== 'admin'">
            <ion-col size-md="12" size-lg="8" offset-lg="2">
                <div class="content-card">
                    <p>{{house.welcomeMessage}}</p>
                    <br />
                    <div class="date-display" *ngIf="house.periodOfStayWidget">
                        <ion-row>
                            <ion-col size="7">
                                <p>Ihre Buchung:</p>
                            </ion-col>
                            <ion-col>
                                <div class="filled-display">
                                    <p>
                                        {{ user.arriveDate | date: "dd.MM" }} - {{ user.leaveDate | date: "dd.MM" }}
                                    </p>
                                </div>
                            </ion-col>
                        </ion-row>
                    </div>
                </div>
            </ion-col>
        </ion-row>

        <ion-row *ngIf="user.role == 'admin'" class="admin-card">
            <ion-col size-md="12" size-lg="8" offset-lg="2">
                <div class="content-card">
                    <p>
                        Sie sind als Administrator eingeloggt. Hier können Sie ganz einfach einen neuen Gast hinzufügen.
                    </p>

                    <br />

                    <ion-button (click)="onOpenAdminPage()" class="admin-button">
                        Gast hinzufügen
                    </ion-button>
                </div>
                <div *ngIf="!loadedUsers$" class="guest-list">
                    <p class="no-guests">momentan keine aktiven Gäste</p>
                </div>
                <div *ngIf="loadedUsers$" class="guest-list">
                    <p class="guest-title">Aktive/Zukünftige Gäste</p>
                    <ion-list *ngFor="let user of loadedUsers$ | async ">
                        <app-user-item [user]="user" (click)="onOpenAdminPage(user)"></app-user-item>
                    </ion-list>
                </div>
            </ion-col>
        </ion-row>

        <ion-row>
            <ion-col size-md="12" size-lg="8" offset-lg="2">
                <app-apartment-info> </app-apartment-info>
                <p>{{apartment}} + !!!!</p>
            </ion-col>
        </ion-row>

        <ion-row class="content-row">
            <ion-col class="content-col" size-md="12" size-lg="8" offset-lg="2">
                <!-- FUNCTIONS BIG -->
                <p class="title">Funktionen</p>
                <app-action-card *ngIf="user.arriveDate > currentDate || user.role == 'admin'" [card]="beforeArrival">
                </app-action-card>

                <app-action-card *ngIf="house.breakfastService" [card]="breakfastService">
                </app-action-card>

                <app-action-card *ngIf="house.saunaService" [card]="saunaService">
                </app-action-card>

                <app-action-card *ngIf="house.feedbackService" [card]="feedbackService">
                </app-action-card>

                <!-- FUNCTIONS SQUARE FORM -->
                <!-- <div class="action-field">
                    <ion-row class="centered-horizontal">
                        <app-action-card-small *ngIf="house.apartmentDetailService" title="Ihre Wohnung" icon="bed" image="/assets/images/apartment.jpeg" (click)="onOpenApartmentDetailPage()">
                        </app-action-card-small>

                        <app-action-card-small *ngIf="house.breakfastService" title="Frühstücks Service" subtitle="Schreiben Sie uns einfach am Vortag eine Liste mit Brötchen, wir bringen Sie am nächsten Morgen vorbei!" icon="bakery_dining" image="/assets/images/bread.jpg" (click)="onOpenBreadOrderPage()">
                        </app-action-card-small>

                        <app-action-card-small *ngIf="house.saunaService" title="Sauna Reservieren" subtitle="Reservieren Sie ganz einfach unsere hauseigene Sauna während Ihres Aufenthaltes!" icon="hot_tub" image="/assets/images/sauna.jpeg" (click)="onOpenReservationPage()">
                        </app-action-card-small>

                        <app-action-card-small *ngIf="house.feedbackService" title="Bewerten Sie uns" icon="grade" image="/assets/images/feedback.jpg" (click)="onOpenFeedbackLink()">
                        </app-action-card-small>

                        < <hr />

                        <ion-button (click)="user.email === 'admin' ? onOpenContactsPage() : onOpenMessagePage()">
                            Nachricht Schreiben
                            <ion-icon name="chatbubbles"></ion-icon>
                        </ion-button>
                    </ion-row>
                </div> -->
            </ion-col>
        </ion-row>
        <ion-row class="space"></ion-row>
    </ion-grid>
    <ion-grid *ngIf="isLoading">
        <div class="spinner-container">
            <ion-spinner name="dots"></ion-spinner>
        </div>
    </ion-grid>
</ion-content>
